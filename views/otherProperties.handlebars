<!DOCTYPE html>


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="../../../../favicon.ico">

    <title>Atlanta Gardens, Farms, Orchards</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</head>

<html>
  <body class = "otherProperties">


      <h1 class="h3 mb-3 font-weight-normal">All Other Valid Properties: </h1>


      <!-- INSERT TABLE -->


      <table id="infoTable" class="table table-bordered table-hover">
          <thead class="thead-light">
              <tr>
                <th scope="col">Name <button id="sortName" class=" sort-btn btn dropdown-toggle float-right" type="button" ></th>
                <th scope="col">Address</th>
                <th scope="col">City <button id="sortName" class=" sort-btn btn dropdown-toggle float-right" type="button" ></th>
                <th scope="col">Zip</th>
                <th scope="col">Size</th>
                <th scope="col">Type</th>
                <th scope="col">Public <button id="sortName" class=" sort-btn btn dropdown-toggle float-right" type="button" ></th>
                <th scope="col">Commercial</th>
                <th scope="col">ID</th>
                <!-- <th scope="col">isValid</th> -->
                <th scope="col">Visits <button id="sortName" class=" sort-btn btn dropdown-toggle float-right" type="button" ></th>
                <th scope="col">Avg. Rating <button id="sortName" class=" sort-btn btn dropdown-toggle float-right" type="button" ></th>
              </tr>
          </thead>

          {{#each allProperty}}
            <tr>
              <td scope="col"> {{this.Name}} </td>
              <td scope="col"> {{this.Address}} </td>
              <td scope="col"> {{this.City}} </td>
              <td scope="col"> {{this.Zip}} </td>
              <td scope="col"> {{this.Size}} </td>
              <td scope="col"> {{this.TYPE}} </td>
              <td scope="col"> {{this.Public}} </td>
              <td scope="col"> {{this.Commercial}} </td>
              <td scope="col"> {{this.ID}} </td>
              <!-- <td scope="col"> {{this.isValid}} </td> -->
              <td scope="col"> {{this.Visits}} </td>
              <td scope="col"> {{this.Rating}} </td>
            </tr>
          {{/each}}

      </table>



      <table class="selection-table">
        <tr>
          <td>
            <div class="center-h-container">
              <div class="not-btn-input">
                <select class="form-control "  id="searchBy">
                  <option>Search by...</option>
                  <option>Name</option>
                  <option>City</option>
                  <option>Type</option>
                  <option>Visits</option>
                  <option>Avg. Rating</option>
                </select>

              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="center-h-container">
              <label for="searchTerm"  required class="sr-only">Search Term</label>
              <input  id="searchTerm" required name="searchTerm" class="form-control not-btn-input" placeholder="Search Term">
            </div>
          </td>
          <td>
            <form method = "POST" action = "/viewPropertyDetails">
              <input type="text" id = "idSelector" name="idSelection" class = "hiddenField" >
              <button class="btn" type="submit" id="viewDet" >View Property Details</button>
            </form>
          </td>
        </tr>
        <tr>
          <form method="POST" action="/otherProperties">
            <input class="hiddenField" name="SearchField" id="SearchField">
            <input class="hiddenField" name="hiddenSearchTerm" id="hiddenSearchTerm">
          <td>
            <button type="submit" name="search" id="searchProperties" class="btn ">Search Properties</button>
          </td>
          <td>
            <a type="button" class="btn" href = "/ownerProperties">Back</a>
          </td>
          <td>
            <div class="empty">
            </div>
          </td>
        </tr>

      </table>
    </form>

  </body>



  <style>
  .sort-btn {
    color: black !important;
    width: 30px !important;
  }

  th>.dropdown-toggle {
      background-color: transparent;
  }

  th>.dropdown-toggle:focus,
  th>.dropdown-toggle:active {
      outline: none !important;
      box-shadow: none;
  }

  .btn {
    width: 300px;
    background-color: #007bff;
    color: #ffffff;
  }
    body {
      display: -ms-flexbox;
      display: -webkit-box;
      display: flex;
      flex-direction: column;
      -ms-flex-align: center;
      -ms-flex-pack: center;
      -webkit-box-align: center;
      align-items: center;
      -webkit-box-pack: center;
      justify-content: center;
      padding-top: 40px;
      padding-bottom: 40px;
      background-color: #f5f5f5;
    }
    .otherProperties {
      width: 100%;
      padding: 50px;
      margin: 0 auto;
    }
    .empty {
      width: 300px;
    }
    .not-btn-input{
      width: 300px;
    }

    .btn {
      width: 300px;
      background-color: #007bff;
      color: #ffffff;
    }
    td {
      text-align: center;
    }
    .selection-table {
      width: 100%;
    }

    .center-h-container{
      display: -ms-flexbox;
      display: -webkit-box;
      display: flex;
      -ms-flex-align: center;
      -ms-flex-pack: center;
      -webkit-box-align: center;
      align-items: center;
      -webkit-box-pack: center;
      justify-content: center;
    }

    .table tbody tr.highlight td {
      background-color: #ddd;
    }

    .hiddenField {
      display: none;
    }

  </style>

</html>

<script>

$('th>.dropdown-toggle').on('click', onClick);


    function onClick(e) {
        var th = $(e.target).parent();
        var col = th.text();
        var table = $(th).parents('table').eq(0);
        var rows = table.find('tr:gt(0)').toArray().sort(compare($(th).index()));
        this.asc = !this.asc;
        if (!this.asc) {
            rows = rows.reverse();
        }
        for (var i = 0; i < rows.length; i++) {
            table.append(rows[i]);
        }
    }

    function compare(index) {
        return function(a, b) {
            var valA = getCellValue(a, index);
            var valB = getCellValue(b, index);
            return $.isNumeric(valA) && $.isNumeric(valB) ? valA - valB : valA.toString().localeCompare(valB);
        }
    }

    function getCellValue(row, index){
        return $(row).children('td').eq(index).text();
    }

(function () {
      if (window.addEventListener) {
          window.addEventListener('load', run, false);
      } else if (window.attachEvent) {
          window.attachEvent('onload', run);
      }

      function run() {
      var t = document.getElementById('infoTable');
      var rows = t.rows;
      for (var i=0; i<rows.length; i++) {
        rows[i].onclick = function (event) {
          //event = event || window.event; // for IE8 backward compatibility
          //console.log(event, this, this.outerHTML);
          if (this.parentNode.nodeName == 'THEAD') {
            return;
          }
          var cells = this.cells; //cells collection
          var id = cells[8].innerHTML;
          $('#idSelector').val(id);
          console.log(id);

        };
      }
      }

  })();


  $('.dropdown-item').click(function() {
      $('#dropdownMenuButton').text('Search by: ' + $(this).text());
  });

  $('#infoTable').on('click', 'tbody tr', function(event) {
    $(this).addClass('highlight').siblings().removeClass('highlight');
  });



  $('#searchTerm').change(function() {
      document.getElementById("hiddenSearchTerm").value = $(this).val();
  });

  (function () {
        if (window.addEventListener) {
            window.addEventListener('load', run, false);
        } else if (window.attachEvent) {
            window.attachEvent('onload', run);
        }

        function run() {
    		var t = document.getElementById('infoTable');
        var rows = t.rows;
    		for (var i=0; i<rows.length; i++) {
    			rows[i].onclick = function (event) {
    				//event = event || window.event; // for IE8 backward compatibility
    				//console.log(event, this, this.outerHTML);
    				if (this.parentNode.nodeName == 'THEAD') {
    					return;
    				}
    				var cells = this.cells; //cells collection
    				var id = cells[8].innerHTML;
            $('#idSelector').val(id);
            //console.log(id);

    			};
    		}
        }

    })();

    $("#viewDet").click(function(e) {
        if ($('#idSelector').val() == '') {
            e.preventDefault();
            window.alert('Please select a property.');
        }
    });

    $('#searchBy').change(function() {
        console.log('entered');
        console.log($(this).val());
        console.log(document.getElementById("SearchField").value);
        document.getElementById("SearchField").value = $(this).val();
        // $("#SearchField").val( $(this).val());

        var searchBy = $(this).val();
        if (searchBy == 'Visits' || searchBy == 'Avg. Rating') {
            document.getElementById('searchTextMin').classList.add("hiddenField");
            document.getElementById('searchTextMax').classList.add("hiddenField");
            $('#searchTextMin').val('');
            $('#searchTextMax').val('');
            $('#checkbox').prop('checked', false);
            $("#searchTextMin").prop('required',false);
            $("#searchTextMax").prop('required',false);
            document.getElementById('checkbox').classList.remove("hiddenField");
            document.getElementById('rangeLabel').classList.remove("hiddenField");
            document.getElementById('searchText').classList.remove("hiddenField");
            $("#searchText").prop('required',true);
        } else {
            document.getElementById('checkbox').classList.add("hiddenField");
            document.getElementById('rangeLabel').classList.add("hiddenField");
            document.getElementById('searchTextMin').classList.add("hiddenField");
            document.getElementById('searchTextMax').classList.add("hiddenField");
            $('#searchTextMin').val('');
            $('#searchTextMax').val('');
            $("#searchTextMin").prop('required',false);
            $("#searchTextMax").prop('required',false);
            document.getElementById('searchText').classList.remove("hiddenField");
            $("#searchText").prop('required',true);

        }

    });
</script>
